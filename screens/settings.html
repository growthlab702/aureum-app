<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configurações</title>

  <link rel="stylesheet" href="../style.css">

  <style>
    body {
      padding: 25px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .config-item {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 15px;
      cursor: pointer;
      font-size: 16px;
      transition: 0.2s;
    }

    .config-item:hover {
      background: #ececec;
    }

    .danger {
      background: #ffdddd;
    }

    .danger:hover {
      background: #ffcccc;
    }

    .version {
      margin-top: 30px;
      text-align: center;
      opacity: 0.6;
      font-size: 14px;
    }
  </style>
</head>

<body>

  <h1>Configurações</h1>

  <div class="config-item" onclick="toggleTema()">
    Alternar tema (Claro / Escuro)
  </div>

  <div class="config-item" onclick="resetProgresso()">
    Resetar progresso
  </div>

  <div class="config-item danger" onclick="apagarConta()">
    Apagar conta / dados
  </div>

  <div class="config-item" onclick="abrirSuporte()">
    Suporte
  </div>

  <button class="btn-voltar" onclick="goTo('home')">Voltar</button>

  <p class="version">Versão 1.0.0</p>

  <script type="module">
    import { loadDB, createEmptyDB } from "../database.js";
    import { goTo } from "../navigation.js";

    window.goTo = goTo;

    // Tema (claro/escuro)
    window.toggleTema = () => {
      const atual = document.body.classList.contains("dark");
      if (atual) {
        document.body.classList.remove("dark");
        localStorage.setItem("theme_lasy", "light");
      } else {
        document.body.classList.add("dark");
        localStorage.setItem("theme_lasy", "dark");
      }
    };

    // Aplicar tema salvo
    const temaSalvo = localStorage.getItem("theme_lasy");
    if (temaSalvo === "dark") {
      document.body.classList.add("dark");
    }

    // Resetar progresso
    window.resetProgresso = () => {
      if (!confirm("Tem certeza que deseja resetar seu progresso?")) return;

      const db = loadDB();

      // Zera apenas progresso, não apaga os dados pessoais
      db.diario = [];
      db.tarefas = {};
      db.materialAtual = null;

      localStorage.setItem("db_lasy", JSON.stringify(db));

      alert("Progresso resetado!");
    };

    // Apagar conta completa
    window.apagarConta = () => {
      if (!confirm("⚠ Isso irá apagar TODOS os dados do app. Continuar?")) return;

      const novoDB = createEmptyDB();
      localStorage.setItem("db_lasy", JSON.stringify(novoDB));

      alert("Conta apagada.");
      goTo("onboarding");
    };

    window.abrirSuporte = () => {
      window.open("https://wa.me/5599999999999", "_blank");
    };
  </script>

</body>

</html>
