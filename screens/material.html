<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Material</title>

  <link rel="stylesheet" href="../style.css">

  <style>
    body {
      padding: 25px;
      max-width: 800px;
      margin: auto;
    }

    h1 {
      margin-bottom: 15px;
      text-align: center;
    }

    .img-box {
      width: 100%;
      border-radius: 12px;
      margin-bottom: 20px;
      overflow: hidden;
    }

    .img-box img {
      width: 100%;
      display: block;
    }

    .conteudo {
      font-size: 17px;
      line-height: 1.6;
      white-space: pre-wrap;
      background: #f4f4f4;
      padding: 20px;
      margin-top: 20px;
      border-radius: 12px;
    }

    .locked-box {
      background: #ffe0e0;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      font-size: 16px;
      margin-top: 20px;
      border: 2px solid #ff6a6a;
    }

    .locked-btn {
      margin-top: 15px;
      background: #ff3b3b;
      color: white;
      padding: 12px;
      border: none;
      width: 100%;
      border-radius: 12px;
      font-size: 17px;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <h1 id="titulo">Carregando...</h1>

  <div id="imagem" class="img-box" style="display:none;">
    <img id="img" src="">
  </div>

  <div id="conteudo" class="conteudo" style="display:none;"></div>

  <div id="locked" class="locked-box" style="display:none;">
    Este material faz parte do <b>Plano Premium</b>.  
    <br><br>
    Desbloqueie todo o conteúdo estético avançado.
    <button class="locked-btn" onclick="goTo('premium')">
      Desbloquear Premium
    </button>
  </div>

  <button onclick="goTo('biblioteca')" class="btn-voltar">Voltar</button>

  <script type="module">
    import { loadDB } from "../database.js";
    import { goTo } from "../navigation.js";

    window.goTo = goTo;

    const db = loadDB();

    const titulo = document.getElementById("titulo");
    const imagem = document.getElementById("imagem");
    const img = document.getElementById("img");
    const conteudo = document.getElementById("conteudo");
    const locked = document.getElementById("locked");

    const materials = db.library || [];
    const atual = materials.find(m => m.id === db.materialAtual);

    if (!atual) {
      titulo.textContent = "Erro ao carregar conteúdo.";
    } else {
      titulo.textContent = atual.titulo;

      // PREMIUM BLOQUEADO
      if (atual.premium && !db.premium) {
        locked.style.display = "block";
        return;
      }

      // EXIBE IMAGEM SE TIVER
      if (atual.imagem) {
        img.src = atual.imagem;
        imagem.style.display = "block";
      }

      // EXIBE TEXTO
      conteudo.textContent = atual.texto || "Conteúdo vazio.";
      conteudo.style.display = "block";
    }
  </script>

</body>

</html>
